@page "/"
@using ClothsStoreSys.Services
@inject ClothsStoreSys.Services.AuthService AuthService
@inject NavigationManager Nav
@inject IAuthService AuthService
@using System.Globalization


@code {
    private bool _redirected;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender || _redirected) return;
        _redirected = true;

        var user = AuthService.GetCurrentUser();
        if (user == null)
        {
            Nav.NavigateTo("/login", true);
            return;
        }

        if (string.Equals(user.Role, "Admin", System.StringComparison.OrdinalIgnoreCase))
        {
            Nav.NavigateTo("/dashboard", true);
        }
        else
        {
            Nav.NavigateTo("/pos", true);
        }
    }
}

<div dir="@(CultureInfo.CurrentCulture.Name.StartsWith("ar") ? "rtl" : "ltr")"></div>